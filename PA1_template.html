<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Introduction</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h3>Introduction</h3>

<p>This is an R Markdown document describing an analysis of personal activity data. For this analysis, data was captured by an activity monitoring device at 5 minute intervals through out the day. The data consists of two months of data from an anonymous individual collected during the months of October and November, 2012 and include the number of steps taken in 5 minute intervals each day.</p>

<p>The data for this assignment can be downloaded from the <a href="https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip">course website:</a></p>

<p>The variables included in this dataset are:  </p>

<ul>
<li>steps: Number of steps taking in a 5-minute interval (missing values are coded as NA)<br/></li>
<li>date: The date on which the measurement was taken in YYYY-MM-DD format<br/></li>
<li>interval: Identifier for the 5-minute interval in which measurement was taken<br/></li>
</ul>

<p>The dataset is stored in a comma-separated-value (CSV) file and there are a total of 17,568 observations in this dataset.</p>

<h3>Objectives</h3>

<p>In this analysis we will examine and visualize severeal statistics that describe the data set, such as the average number of steps per day, daily activity patterns and the difference between activity on weekdays versus weekends.</p>

<p>Outputs from the analysis are:  </p>

<ol>
<li>Code for reading in the dataset and/or processing the data<br/></li>
<li>Histogram of the total number of steps taken each day<br/></li>
<li>Mean and median number of steps taken each day<br/></li>
<li>Time series plot of the average number of steps taken<br/></li>
<li>The interval that, on average, contains the maximum number of steps<br/></li>
<li>Code to describe and show a strategy for imputing missing data<br/></li>
<li>Histogram of the total number of steps taken each day after missing values are imputed<br/></li>
<li>Panel plot comparing the average number of steps taken per 5-minute interval across weekdays and weekends<br/></li>
<li>All of the R code needed to reproduce the results (numbers, plots, etc.) in the report (also included with output 1 to 8)<br/></li>
</ol>

<h3>Code for preparing the workspace</h3>

<p>For this analysis we use the ggplot2, Hmisc and dplyr packages. (Loading messages are suppressed here.)</p>

<pre><code class="r"># Prep workspace ----------------------------------------------------------
library(ggplot2)
library(Hmisc)
library(dplyr)
</code></pre>

<h3>1 - Code for reading in the dataset and/or processing the data</h3>

<p>We assume the data file is in the same folder as this Markdown file, that that is also the working directory and that the file is called &ldquo;data_activity.csv&rdquo;.</p>

<pre><code class="r"># Loading and preprocessing the data --------------------------------------
Data &lt;- read.csv(&quot;data_activity.csv&quot;, header = TRUE, sep = &quot;,&quot;)
str(Data)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    17568 obs. of  3 variables:
##  $ steps   : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ date    : Factor w/ 61 levels &quot;2012-10-01&quot;,&quot;2012-10-02&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ interval: int  0 5 10 15 20 25 30 35 40 45 ...
</code></pre>

<h3>2 - Histogram of the total number of steps taken each day</h3>

<p>For this part of the analysis, we ignore missing values.</p>

<p>2.1 - Calculate the total number of steps taken per day </p>

<pre><code class="r">DataStepsByDate &lt;- aggregate(data = Data, steps ~ date, sum)
head(DataStepsByDate, 3)
</code></pre>

<pre><code>##         date steps
## 1 2012-10-02   126
## 2 2012-10-03 11352
## 3 2012-10-04 12116
</code></pre>

<p>2.2 - Make a histogram of the total number of steps taken each day</p>

<pre><code class="r">par(cex = 0.75)
hist(DataStepsByDate$steps, col = &quot;ivory2&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk histstepsbyday"/></p>

<h3>3 - Mean and median number of steps taken each day</h3>

<pre><code class="r">Mean1 &lt;- DataStepsByDate &lt;- aggregate(data = Data, steps ~ date, mean)
Mean1
</code></pre>

<pre><code>##          date      steps
## 1  2012-10-02  0.4375000
## 2  2012-10-03 39.4166667
## 3  2012-10-04 42.0694444
## 4  2012-10-05 46.1597222
## 5  2012-10-06 53.5416667
## 6  2012-10-07 38.2465278
## 7  2012-10-09 44.4826389
## 8  2012-10-10 34.3750000
## 9  2012-10-11 35.7777778
## 10 2012-10-12 60.3541667
## 11 2012-10-13 43.1458333
## 12 2012-10-14 52.4236111
## 13 2012-10-15 35.2048611
## 14 2012-10-16 52.3750000
## 15 2012-10-17 46.7083333
## 16 2012-10-18 34.9166667
## 17 2012-10-19 41.0729167
## 18 2012-10-20 36.0937500
## 19 2012-10-21 30.6284722
## 20 2012-10-22 46.7361111
## 21 2012-10-23 30.9652778
## 22 2012-10-24 29.0104167
## 23 2012-10-25  8.6527778
## 24 2012-10-26 23.5347222
## 25 2012-10-27 35.1354167
## 26 2012-10-28 39.7847222
## 27 2012-10-29 17.4236111
## 28 2012-10-30 34.0937500
## 29 2012-10-31 53.5208333
## 30 2012-11-02 36.8055556
## 31 2012-11-03 36.7048611
## 32 2012-11-05 36.2465278
## 33 2012-11-06 28.9375000
## 34 2012-11-07 44.7326389
## 35 2012-11-08 11.1770833
## 36 2012-11-11 43.7777778
## 37 2012-11-12 37.3784722
## 38 2012-11-13 25.4722222
## 39 2012-11-15  0.1423611
## 40 2012-11-16 18.8923611
## 41 2012-11-17 49.7881944
## 42 2012-11-18 52.4652778
## 43 2012-11-19 30.6979167
## 44 2012-11-20 15.5277778
## 45 2012-11-21 44.3993056
## 46 2012-11-22 70.9270833
## 47 2012-11-23 73.5902778
## 48 2012-11-24 50.2708333
## 49 2012-11-25 41.0902778
## 50 2012-11-26 38.7569444
## 51 2012-11-27 47.3819444
## 52 2012-11-28 35.3576389
## 53 2012-11-29 24.4687500
</code></pre>

<pre><code class="r">Median1 &lt;- DataStepsByDate &lt;- aggregate(data = Data, steps ~ date, median)
Median1
</code></pre>

<pre><code>##          date steps
## 1  2012-10-02     0
## 2  2012-10-03     0
## 3  2012-10-04     0
## 4  2012-10-05     0
## 5  2012-10-06     0
## 6  2012-10-07     0
## 7  2012-10-09     0
## 8  2012-10-10     0
## 9  2012-10-11     0
## 10 2012-10-12     0
## 11 2012-10-13     0
## 12 2012-10-14     0
## 13 2012-10-15     0
## 14 2012-10-16     0
## 15 2012-10-17     0
## 16 2012-10-18     0
## 17 2012-10-19     0
## 18 2012-10-20     0
## 19 2012-10-21     0
## 20 2012-10-22     0
## 21 2012-10-23     0
## 22 2012-10-24     0
## 23 2012-10-25     0
## 24 2012-10-26     0
## 25 2012-10-27     0
## 26 2012-10-28     0
## 27 2012-10-29     0
## 28 2012-10-30     0
## 29 2012-10-31     0
## 30 2012-11-02     0
## 31 2012-11-03     0
## 32 2012-11-05     0
## 33 2012-11-06     0
## 34 2012-11-07     0
## 35 2012-11-08     0
## 36 2012-11-11     0
## 37 2012-11-12     0
## 38 2012-11-13     0
## 39 2012-11-15     0
## 40 2012-11-16     0
## 41 2012-11-17     0
## 42 2012-11-18     0
## 43 2012-11-19     0
## 44 2012-11-20     0
## 45 2012-11-21     0
## 46 2012-11-22     0
## 47 2012-11-23     0
## 48 2012-11-24     0
## 49 2012-11-25     0
## 50 2012-11-26     0
## 51 2012-11-27     0
## 52 2012-11-28     0
## 53 2012-11-29     0
</code></pre>

<h3>4 - Time series plot of the average number of steps taken</h3>

<p>4.1 - Aggregate the data into mean steps by interval </p>

<pre><code class="r">DataStepsByItv &lt;- aggregate(data = Data, steps ~ interval, mean)
</code></pre>

<p>4.2 - Create the plot</p>

<pre><code class="r">PlotActivity &lt;- ggplot(data = DataStepsByItv, aes(x = interval, y = steps)) +
      geom_line(size = 1, color = &quot;ivory4&quot;) +
      labs(title = &quot;Mean steps by interval&quot;) +
      theme_minimal()
PlotActivity
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk dailypatternplot"/></p>

<h3>5 - The interval that, on average, contains the maximum number of steps</h3>

<pre><code class="r">MaxItv &lt;- with(DataStepsByItv, interval[[which.max(steps)]])
MaxItv
</code></pre>

<pre><code>## [1] 835
</code></pre>

<h3>6 - Code to describe and show a strategy for imputing missing data</h3>

<p>6.1 Calculate and report the total number of rows with NAs</p>

<pre><code class="r">sum(is.na(Data$steps))
</code></pre>

<pre><code>## [1] 2304
</code></pre>

<p>6.2 Create a new dataset with NA&#39;s imputed by <em>the mean for the interval.</em>
After unsuccessfully trying to do this with the impute function from the Hmisc package, I decided to solve this with a merge/which(is.na()) construction.   </p>

<ul>
<li>First step, we create a temporary data frame, which is a merge between the original data and the aggregated data containing the average steps by interval. The original column with the nr. of steps for each interval is now called steps.x, and there is an additional column that contains the average nr. of steps for each interval, called steps.y.<br/></li>
<li>Second step, in the temporary data frame, we identify the rows in steps.x that contain NA, and replace them with the corresponding values from steps.y.<br/></li>
<li>Third step, we create a new copy of the original data frame, and replace the steps column with the imputed column from the temporary data frame.<br/></li>
<li>Fourth and fifth step, since the merge has changed the order of the rows, we also replace the date and interval columns with those of the temporary data frame.<br/></li>
<li>We now have a clean new data frame with NA&#39;s imputed by the mean of the interval.</li>
</ul>

<pre><code class="r">DataTemp &lt;- merge(Data, DataStepsByItv, by = &quot;interval&quot;)
DataTemp$steps.x[which(is.na(DataTemp$steps.x))] &lt;-
      DataTemp$steps.y[which(is.na(DataTemp$steps.x))]
DataNew &lt;- Data
DataNew$steps &lt;- DataTemp$steps.x
DataNew$date &lt;- DataTemp$date
DataNew$interval &lt;- DataTemp$interval
head(DataNew, 3)
</code></pre>

<pre><code>##      steps       date interval
## 1 1.716981 2012-10-01        0
## 2 0.000000 2012-11-23        0
## 3 0.000000 2012-10-28        0
</code></pre>

<h3>7 - Histogram of the total number of steps taken each day after missing values are imputed</h3>

<p>7.1 - Calculate the total number of steps taken per day </p>

<pre><code class="r">DataStepsByDate2 &lt;- aggregate(data = DataNew, steps ~ date, sum)
head(DataStepsByDate2, 3)
</code></pre>

<pre><code>##         date    steps
## 1 2012-10-01 10766.19
## 2 2012-10-02   126.00
## 3 2012-10-03 11352.00
</code></pre>

<p>7.2 - Make a histogram of the total number of steps taken each day</p>

<pre><code class="r">par(cex = 0.75)
hist(DataStepsByDate2$steps, col = &quot;ivory2&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk histstepsbyday2"/></p>

<h3>8 - Panel plot comparing the average number of steps taken per 5-minute interval across weekdays and weekends</h3>

<p>8.1 - To do this we first need to Create a new factor variable in the dataset with two levels - &ldquo;weekday&rdquo; and &ldquo;weekend&rdquo; indicating whether a given date is a weekday or weekend day.</p>

<ul>
<li>First step, we create a new data frame</li>
<li>Second step, we create a new column with the day of the week</li>
<li>Third step, we substitute Saturdays and Sundays by &ldquo;Weekend&rdquo;, and Mondays thru Fridays by &ldquo;Weekday&rdquo;.</li>
<li>Fourth step, we mutate from a character to a factor variable so that we can use it as facet in our plot.</li>
</ul>

<pre><code class="r">DataNewer &lt;- DataNew
DataNewer$dow &lt;- weekdays(as.POSIXct(DataNewer$date), abbreviate = TRUE)
DataNewer$dow &lt;-
      gsub(&quot;(Sat|Sun)&quot;,
           &quot;Weekend&quot;, 
           DataNewer$dow, 
           ignore.case = TRUE)
DataNewer$dow &lt;-
      gsub(&quot;(Mon|Tue|Wed|Thu|Fri)&quot;,
           &quot;Weekday&quot;,
           DataNewer$dow,
           ignore.case = TRUE)
DataNewer$dow &lt;- as.factor(DataNewer$dow)
</code></pre>

<p>8.2 - Now we aggregate the new data and create the plot</p>

<pre><code class="r">DataStepsByItv2 &lt;- aggregate(data = DataNewer, steps ~ interval + dow, mean)
PlotActivity2 &lt;- ggplot(data = DataStepsByItv2, aes(x = interval, y = steps)) +
      geom_line(size = 1, color = &quot;ivory4&quot;) +
      labs(title = &quot;Mean steps by interval&quot;) +
      facet_grid(dow ~ .) +
      theme_minimal()
PlotActivity2
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk plotdow"/></p>

<h3>9 -</h3>

<p>To run this entire code at once, here is the whole script:</p>

<pre><code class="r"># Prep workspace ----------------------------------------------------------

library(ggplot2)
library(Hmisc)
library(dplyr)


# Loading and preprocessing the data --------------------------------------
Data &lt;- read.csv(&quot;data_activity.csv&quot;, header = TRUE, sep = &quot;,&quot;)
str(Data)


# Steps per day -----------------------------------------------------------

# Calculate the total nr of steps taken each day
DataStepsByDate &lt;- aggregate(data = Data, steps ~ date, sum)
DataStepsByDate

# Make a histogram of the total number of steps taken each day
par(cex = 0.75)
hist(DataStepsByDate$steps, col = &quot;ivory2&quot;)

# What are the mean and median total number of steps taken per day?
Mean1 &lt;- DataStepsByDate &lt;- aggregate(data = Data, steps ~ date, mean)
Mean1
Median1 &lt;- DataStepsByDate &lt;- aggregate(data = Data, steps ~ date, median)
Median1


# Daily activity ----------------------------------------------------------

# What is the average daily activity pattern?
DataStepsByItv &lt;- aggregate(data = Data, steps ~ interval, mean)
PlotActivity &lt;- ggplot(data = DataStepsByItv, aes(x = interval, y = steps)) +
      geom_line(size = 1, color = &quot;ivory4&quot;) +
      labs(title = &quot;Mean steps by interval&quot;) +
      theme_minimal()
PlotActivity

# Which interval, on avg across all days contains the maximum number of steps?
MaxItv &lt;- with(DataStepsByItv, interval[[which.max(steps)]])
MaxItv


# Imputing missing values -------------------------------------------------

# Calculate and report the total number of rows with NAs
sum(is.na(Data$steps))

# Create a new dataset with NA&#39;s imputed by the mean for the interval.
# After unsuccessfully trying to do this with one of the obvious but not so easy
# impute solutions (Hmisc, MICE, etc) I finally decided to solve this the 
# conventional way. Gosh I miss Excel.
DataTemp &lt;- merge(Data, DataStepsByItv, by = &quot;interval&quot;)
DataTemp$steps.x[which(is.na(DataTemp$steps.x))] &lt;-
      DataTemp$steps.y[which(is.na(DataTemp$steps.x))]
DataNew &lt;- Data
DataNew$steps &lt;- DataTemp$steps.x
DataNew$date &lt;- DataTemp$date
DataNew$interval &lt;- DataTemp$interval
head(DataNew, 3)

# Calculate the total nr of steps taken each day
DataStepsByDate2 &lt;- aggregate(data = DataNew, steps ~ date, sum)
head(DataStepsByDate2, 3)

# Make a histogram of the total number of steps taken each day
par(cex = 0.75)
hist(DataStepsByDate2$steps, col = &quot;ivory2&quot;)

# What are the mean and median total number of steps taken per day?
Mean2 &lt;- DataStepsByDate2 &lt;- aggregate(data = DataNew, steps ~ date, mean)
Mean2
Median2 &lt;- DataStepsByDate2 &lt;- aggregate(data = DataNew, steps ~ date, median)
Median2


# Weekdays vs weekends ----------------------------------------------------

# Are there differences in activity patterns between weekdays and weekends?
# Create a new factor variable in the dataset with two levels - &quot;weekday&quot; and
# &quot;weekend&quot; indicating whether a given date is a weekday or weekend day.

DataNewer &lt;- DataNew
DataNewer$dow &lt;- weekdays(as.POSIXct(DataNewer$date), abbreviate = TRUE)
DataNewer$dow &lt;-
      gsub(&quot;(Sat|Sun)&quot;,
           &quot;Weekend&quot;, 
           DataNewer$dow, 
           ignore.case = TRUE)
DataNewer$dow &lt;-
      gsub(&quot;(Mon|Tue|Wed|Thu|Fri)&quot;,
           &quot;Weekday&quot;,
           DataNewer$dow,
           ignore.case = TRUE)
DataNewer$dow &lt;- as.factor(DataNewer$dow)

# Make a panel with time series plots of the average number of steps taken per
# interval, averaged across all weekdays or weekend days.

DataStepsByItv2 &lt;- aggregate(data = DataNewer, steps ~ interval + dow, mean)
PlotActivity2 &lt;- ggplot(data = DataStepsByItv2, aes(x = interval, y = steps)) +
      geom_line(size = 1, color = &quot;ivory4&quot;) +
      labs(title = &quot;Mean steps by interval&quot;) +
      facet_grid(dow ~ .) +
      theme_minimal()
PlotActivity2


# End ---------------------------------------------------------------------
</code></pre>

</body>

</html>
